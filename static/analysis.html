<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анализ</title>
    <script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-bundle.min.js"></script>
    <style>
        /* Общий стиль страницы */
        body {
            background-color: #1C1C1E;
            color: #E5E5E5;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        /* Заголовок */
        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Контейнер для графика */
        .graphs-container {
            display: flex;
            justify-content: center;
            width: 100%;
            height: 75%; /* Высота графика 75% */
            margin-top: 20px;
        }

        /* График */
        .graph {
            width: 75%; /* График будет занимать 75% ширины */
            height: 100%; /* Высота графика будет 100% от контейнера */
        }

        /* График контейнера */
        #container {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
<h1>Анализ</h1>
<div class="graphs-container">
    <div id="container" class="graph"></div>
</div>
</body>

<script>
    var isBetweenDragAndClick = false;

    anychart.onDocumentReady(function() {
        var data = {
            nodes: {{ nodes | safe }},
        edges: {{ edges | safe }}
    };

        var chart = anychart.graph(data);

        chart.listen("click", function(e) {
            // window.location.href = "/route/" + id;  // Перенаправляем на новую страницу
        });
        chart.listen('mousemove', function(e) {
            // there should be some other logic for your dragging
            isBetweenDragAndClick = true;
        })
        chart.listen('click', function(e) {
            if(isBetweenDragAndClick) {
                isBetweenDragAndClick = false;
                return;
            }

            let type = e.domTarget.tag?.type;
            let id = e.domTarget.tag?.id;

            if (type === 'node') {
                window.open("/address/" + id, "_blank");
            } else if (type === 'edge') {
                window.open("/tx/" + id, "_blank");
            }
        })

        chart.container("container");
        chart.draw();
    });
</script>
</html>
